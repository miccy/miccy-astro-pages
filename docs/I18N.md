# Implementace v√≠cejazyƒçnosti v Astro

Tento dokument popisuje, jak implementovat v√≠cejazyƒçnost (i18n) v Astro projektu v r√°mci monorepo struktury.

## P≈ôehled mo≈ænost√≠ pro v√≠cejazyƒçnost v Astro

Pro implementaci v√≠cejazyƒçnosti v Astro m√°me nƒõkolik mo≈ænost√≠:

1. **astro-i18n-aut** - Jednoduch√° a flexibiln√≠ knihovna
2. **astro-i18n** - Komplexnƒõj≈°√≠ ≈ôe≈°en√≠ s vƒõt≈°√≠m mno≈æstv√≠m funkc√≠
3. **astro-i18next** - Wrapper kolem i18next
4. **Nativn√≠ p≈ô√≠stup** - Pou≈æit√≠ adres√°≈ôov√© struktury a dynamick√Ωch rout≈Ø

Pro na≈°e portfolio doporuƒçuji pou≈æ√≠t `astro-i18n-aut` pro jej√≠ jednoduchost a dobrou integraci s Astro.

## Instalace a konfigurace astro-i18n-aut

### 1. Instalace

```bash
cd apps/portfolio
bun add astro-i18n-aut
```

### 2. Konfigurace v astro.config.mjs

```js
import { defineConfig } from "astro/config";
import tailwind from "@astrojs/tailwind";
import astroI18n from "astro-i18n-aut/integration";

export default defineConfig({
  integrations: [
    tailwind({
      config: { path: "../../packages/config/tailwind/index.js" }
    }),
    astroI18n({
      defaultLanguage: "cs",
      supportedLanguages: ["cs", "en"],
      translationLoadingRules: ["./src/i18n/[lang].json"]
    })
  ],
  site: "https://miccy.github.io"
});
```

### 3. Vytvo≈ôen√≠ p≈ôekladov√Ωch soubor≈Ø

Vytvo≈ôte adres√°≈ô `src/i18n` a v nƒõm p≈ôekladov√© soubory pro ka≈æd√Ω jazyk:

```json
// src/i18n/cs.json
{
  "nav": {
    "home": "Dom≈Ø",
    "about": "O mnƒõ",
    "experience": "Zku≈°enosti",
    "projects": "Projekty",
    "contact": "Kontakt"
  },
  "hero": {
    "title": "Ahoj, jsem Milo≈° Macek",
    "subtitle": "Full Stack Developer",
    "cta": "Zjistit v√≠ce"
  },
  "about": {
    "title": "O mnƒõ",
    "description": "Jsem full stack v√Ωvoj√°≈ô se zamƒõ≈ôen√≠m na...",
    "skills": "Mezi m√© dovednosti pat≈ô√≠..."
  }
}
```

```json
// src/i18n/en.json
{
  "nav": {
    "home": "Home",
    "about": "About",
    "experience": "Experience",
    "projects": "Projects",
    "contact": "Contact"
  },
  "hero": {
    "title": "Hi, I'm Milo≈° Macek",
    "subtitle": "Full Stack Developer",
    "cta": "Learn more"
  },
  "about": {
    "title": "About Me",
    "description": "I'm a full stack developer focusing on...",
    "skills": "My skills include..."
  }
}
```

## Pou≈æit√≠ p≈ôeklad≈Ø v komponent√°ch

### 1. Z√°kladn√≠ pou≈æit√≠

```astro
---
// src/components/Hero.astro
import { useTranslations } from 'astro-i18n-aut';

const t = useTranslations(Astro);
---

<section class="py-20">
  <div class="container mx-auto px-6">
    <h1 class="text-5xl font-bold mb-4">{t('hero.title')}</h1>
    <p class="text-2xl mb-8">{t('hero.subtitle')}</p>
    <a href="#about" class="btn">{t('hero.cta')}</a>
  </div>
</section>
```

### 2. P≈ôep√≠naƒç jazyk≈Ø

Vytvo≈ôte komponentu pro p≈ôep√≠n√°n√≠ jazyk≈Ø:

```astro
---
// packages/ui/components/LanguageSelector/LanguageSelector.astro
import { getLanguageFromURL, useTranslatedPath } from 'astro-i18n-aut';

const currentPath = Astro.url.pathname;
const currentLanguage = getLanguageFromURL(currentPath) || 'cs';
const translatePath = useTranslatedPath(Astro);

const languages = [
  { code: 'cs', name: 'üá®üáø ƒåesky' },
  { code: 'en', name: 'üá¨üáß English' }
];
---

<div class="language-selector">
  {languages.map(language => (
    <a
      href={translatePath('/', language.code)}
      class={`lang-link ${currentLanguage === language.code ? 'active' : ''}`}
    >
      {language.name}
    </a>
  ))}
</div>

<style>
  .language-selector {
    display: flex;
    gap: 0.5rem;
  }
  .lang-link {
    padding: 0.5rem;
    border-radius: 0.25rem;
    cursor: pointer;
  }
  .lang-link:hover {
    background-color: var(--hover-color);
  }
  .lang-link.active {
    background-color: var(--active-color);
    font-weight: bold;
  }
</style>
```

## Routov√°n√≠ pro v√≠cejazyƒçn√© str√°nky

### 1. Struktura routov√°n√≠

Knihovna `astro-i18n-aut` podporuje dva p≈ô√≠stupy k routov√°n√≠:

#### A. Automatick√© generov√°n√≠ rout≈Ø

P≈ôi pou≈æit√≠ defaultn√≠ho nastaven√≠ se routy pro jazyk vytvo≈ô√≠ automaticky:

- `/` - v√Ωchoz√≠ jazyk (cs)
- `/en/` - anglick√° verze
- `/en/about` - anglick√° verze str√°nky "about"

#### B. Explicitn√≠ routov√°n√≠ pomoc√≠ adres√°≈ôov√© struktury

Alternativnƒõ m≈Ø≈æete vytvo≈ôit adres√°≈ôovou strukturu:

```
src/pages/
‚îú‚îÄ‚îÄ index.astro          # V√Ωchoz√≠ jazyk (cs)
‚îú‚îÄ‚îÄ about.astro          # V√Ωchoz√≠ jazyk (cs)
‚îú‚îÄ‚îÄ en/
‚îÇ   ‚îú‚îÄ‚îÄ index.astro      # Anglick√° hlavn√≠ str√°nka
‚îÇ   ‚îî‚îÄ‚îÄ about.astro      # Anglick√° str√°nka "about"
```

### 2. Implementace z√°kladn√≠ str√°nky s p≈ôep√≠n√°n√≠m jazyka

```astro
---
// src/pages/index.astro
import { MainLayout } from '@miccy/ui/layouts';
import { useTranslations } from 'astro-i18n-aut';
import Hero from '../components/Hero.astro';
import About from '../components/About.astro';
import Projects from '../components/Projects.astro';

const t = useTranslations(Astro);
---

<MainLayout title={t('meta.homeTitle')} description={t('meta.homeDescription')}>
  <Hero />
  <About />
  <Projects />
</MainLayout>
```

## Generov√°n√≠ dynamick√Ωch str√°nek pro ka≈æd√Ω jazyk

### 1. Pou≈æit√≠ Content Collections s v√≠cejazyƒçnost√≠

Vytvo≈ôte Content Collections pro projekty:

```ts
// src/content/config.ts
import { defineCollection, z } from "astro:content";

const projectsCollection = defineCollection({
  schema: z.object({
    title: z.string(),
    description: z.string(),
    image: z.string(),
    tags: z.array(z.string()),
    url: z.string().optional(),
    github: z.string().optional(),
    language: z.enum(["cs", "en"]) // Jazyk obsahu
  })
});

export const collections = {
  projects: projectsCollection
};
```

### 2. Vytvo≈ôen√≠ obsahu pro ka≈æd√Ω jazyk

```md
## // src/content/projects/project-1-cs.md

title: "M≈Øj Projekt"
description: "Popis projektu v ƒçe≈°tinƒõ"
image: "/images/project1.jpg"
tags: ["React", "TypeScript", "Tailwind"]
url: "https://example.com"
github: "https://github.com/miccy/project"
language: "cs"

---

Detailn√≠ popis projektu v ƒçe≈°tinƒõ...
```

```md
## // src/content/projects/project-1-en.md

title: "My Project"
description: "Project description in English"
image: "/images/project1.jpg"
tags: ["React", "TypeScript", "Tailwind"]
url: "https://example.com"
github: "https://github.com/miccy/project"
language: "en"

---

Detailed project description in English...
```

### 3. Dynamick√© generov√°n√≠ str√°nek projektu

```astro
---
// src/pages/project/[slug].astro
import { getCollection } from 'astro:content';
import { MainLayout } from '@miccy/ui/layouts';
import { getLanguageFromURL, useTranslatedPath } from 'astro-i18n-aut';

export async function getStaticPaths() {
  const projects = await getCollection('projects');

  return projects.map(project => {
    const slug = project.id.replace(/-[a-z]{2}$/, ''); // Odstranƒõn√≠ jazykov√©ho sufixu
    return {
      params: {
        slug
      },
      props: {
        project,
        language: project.data.language
      }
    };
  });
}

const { project, language } = Astro.props;
const { Content } = await project.render();

// Z√≠skat aktu√°ln√≠ jazyk z URL
const currentLanguage = getLanguageFromURL(Astro.url.pathname) || 'cs';

// Pokud jazyk obsahu neodpov√≠d√° jazyku URL, p≈ôesmƒõruj
if (language !== currentLanguage) {
  const translatePath = useTranslatedPath(Astro);
  return Astro.redirect(translatePath(`/project/${Astro.params.slug}`), 302);
}
---

<MainLayout title={project.data.title}>
  <article class="container mx-auto px-6 py-12">
    <h1 class="text-4xl font-bold mb-6">{project.data.title}</h1>
    <p class="text-lg mb-8">{project.data.description}</p>

    <div class="mb-8">
      <img src={project.data.image} alt={project.data.title} class="w-full h-auto rounded-lg" />
    </div>

    <div class="prose dark:prose-invert max-w-none">
      <Content />
    </div>
  </article>
</MainLayout>
```

## SEO pro v√≠cejazyƒçn√© str√°nky

### 1. P≈ôid√°n√≠ hreflang tag≈Ø

Vytvo≈ôte komponentu pro hreflang tagy:

```astro
---
// src/components/HreflangTags.astro
import { useTranslatedPath } from 'astro-i18n-aut';

interface Props {
  supportedLanguages: string[];
  currentPath: string;
}

const { supportedLanguages, currentPath } = Astro.props;
const translatePath = useTranslatedPath(Astro);
const canonicalUrl = new URL(currentPath, Astro.site);
---

{supportedLanguages.map(lang => (
  <link
    rel="alternate"
    hreflang={lang}
    href={new URL(translatePath(currentPath, lang), Astro.site).href}
  />
))}
<link rel="canonical" href={canonicalUrl} />
```

### 2. Pou≈æit√≠ v layoutu

```astro
---
// packages/ui/layouts/MainLayout/MainLayout.astro
import HreflangTags from '../../components/HreflangTags.astro';

// ... existuj√≠c√≠ k√≥d ...

const supportedLanguages = ['cs', 'en'];
const currentPath = Astro.url.pathname;
---

<html lang={lang}>
  <head>
    <!-- ... existuj√≠c√≠ meta tagy ... -->
    <HreflangTags
      supportedLanguages={supportedLanguages}
      currentPath={currentPath}
    />
  </head>
  <!-- ... existuj√≠c√≠ k√≥d ... -->
</html>
```

## P≈ôeklad dynamick√©ho obsahu

### 1. Naƒç√≠t√°n√≠ p≈ôeklad≈Ø v JavaScript

```ts
// src/utils/i18n.ts
import { getLanguageFromURL } from "astro-i18n-aut";

export async function getTranslations(language: string) {
  const defaultLanguage = "cs";
  const lang = language || defaultLanguage;

  try {
    const translations = await import(`../i18n/${lang}.json`);
    return translations.default;
  } catch (e) {
    console.error(`Failed to load translations for ${lang}`, e);
    // Fallback na v√Ωchoz√≠ jazyk
    const defaultTranslations = await import(`../i18n/${defaultLanguage}.json`);
    return defaultTranslations.default;
  }
}

export function getCurrentLanguage(url: URL): string {
  return getLanguageFromURL(url.pathname) || "cs";
}
```

### 2. Pou≈æit√≠ v klientsk√Ωch komponent√°ch

```astro
---
// src/components/DynamicForm.astro
---

<div id="dynamic-form">
  <!-- Bude naplnƒõno JavaScript k√≥dem -->
</div>

<script>
  import { getTranslations, getCurrentLanguage } from '../utils/i18n';

  async function initForm() {
    const language = getCurrentLanguage(window.location);
    const translations = await getTranslations(language);

    const form = document.getElementById('dynamic-form');
    if (!form) return;

    form.innerHTML = `
      <h3>${translations.contact.formTitle}</h3>
      <form>
        <label>${translations.contact.nameLabel}</label>
        <input type="text" placeholder="${translations.contact.namePlaceholder}">

        <label>${translations.contact.emailLabel}</label>
        <input type="email" placeholder="${translations.contact.emailPlaceholder}">

        <label>${translations.contact.messageLabel}</label>
        <textarea placeholder="${translations.contact.messagePlaceholder}"></textarea>

        <button type="submit">${translations.contact.submitButton}</button>
      </form>
    `;
  }

  // Inicializovat p≈ôi naƒçten√≠ str√°nky
  document.addEventListener('DOMContentLoaded', initForm);

  // Reinicializovat p≈ôi navigaci (pro SPA chov√°n√≠)
  document.addEventListener('astro:page-load', initForm);
</script>
```

## Optimalizace p≈ôeklad≈Ø

### 1. Dƒõlen√≠ p≈ôeklad≈Ø pro lep≈°√≠ v√Ωkon

Pro rozs√°hlej≈°√≠ p≈ôeklady je vhodn√© rozdƒõlit je do men≈°√≠ch soubor≈Ø:

```
src/i18n/
‚îú‚îÄ‚îÄ cs/
‚îÇ   ‚îú‚îÄ‚îÄ common.json
‚îÇ   ‚îú‚îÄ‚îÄ home.json
‚îÇ   ‚îú‚îÄ‚îÄ about.json
‚îÇ   ‚îî‚îÄ‚îÄ projects.json
‚îú‚îÄ‚îÄ en/
‚îÇ   ‚îú‚îÄ‚îÄ common.json
‚îÇ   ‚îú‚îÄ‚îÄ home.json
‚îÇ   ‚îú‚îÄ‚îÄ about.json
‚îÇ   ‚îî‚îÄ‚îÄ projects.json
```

### 2. Naƒç√≠t√°n√≠ pouze pot≈ôebn√Ωch p≈ôeklad≈Ø

```ts
// src/utils/i18n.ts
export async function getPageTranslations(language: string, page: string) {
  const defaultLanguage = "cs";
  const lang = language || defaultLanguage;

  try {
    // Naƒç√≠st obecn√© p≈ôeklady
    const commonTranslations = await import(`../i18n/${lang}/common.json`);

    // Naƒç√≠st p≈ôeklady pro konkr√©tn√≠ str√°nku
    const pageTranslations = await import(`../i18n/${lang}/${page}.json`);

    // Slouƒçit p≈ôeklady
    return {
      ...commonTranslations.default,
      ...pageTranslations.default
    };
  } catch (e) {
    console.error(`Failed to load translations for ${lang}/${page}`, e);
    return {};
  }
}
```

## Z√°vƒõr

Tato implementace v√≠cejazyƒçnosti poskytuje robustn√≠ z√°klad pro vytvo≈ôen√≠ dvojjazyƒçn√©ho portfolia pomoc√≠ Astro. P≈ô√≠stup s knihovnou `astro-i18n-aut` nab√≠z√≠ dostateƒçnou flexibilitu pro vƒõt≈°inu bƒõ≈æn√Ωch p≈ô√≠pad≈Ø pou≈æit√≠ a umo≈æ≈àuje snadn√© p≈ôid√°n√≠ dal≈°√≠ch jazyk≈Ø v budoucnu.

Pro roz≈°√≠≈ôenƒõj≈°√≠ projekty nebo specifick√© pot≈ôeby lze zv√°≈æit komplexnƒõj≈°√≠ ≈ôe≈°en√≠ jako `astro-i18next` nebo vlastn√≠ implementaci zalo≈æenou na Content Collections a dynamick√Ωch routech.
