# Implementace vÃ­cejazyÄnosti v Astro

Tento dokument popisuje, jak implementovat vÃ­cejazyÄnost (i18n) v Astro projektu v rÃ¡mci monorepo struktury.

## PÅ™ehled moÅ¾nostÃ­ pro vÃ­cejazyÄnost v Astro

Pro implementaci vÃ­cejazyÄnosti v Astro mÃ¡me nÄ›kolik moÅ¾nostÃ­:

1. **astro-i18n-aut** - JednoduchÃ¡ a flexibilnÃ­ knihovna
2. **astro-i18n** - KomplexnÄ›jÅ¡Ã­ Å™eÅ¡enÃ­ s vÄ›tÅ¡Ã­m mnoÅ¾stvÃ­m funkcÃ­
3. **astro-i18next** - Wrapper kolem i18next
4. **NativnÃ­ pÅ™Ã­stup** - PouÅ¾itÃ­ adresÃ¡Å™ovÃ© struktury a dynamickÃ½ch routÅ¯

Pro naÅ¡e portfolio doporuÄuji pouÅ¾Ã­t `astro-i18n-aut` pro jejÃ­ jednoduchost a dobrou integraci s Astro.

## Instalace a konfigurace astro-i18n-aut

### 1. Instalace

```bash
cd apps/portfolio
bun add astro-i18n-aut
```

### 2. Konfigurace v astro.config.mjs

```js
import { defineConfig } from "astro/config";
import tailwind from "@astrojs/tailwind";
import astroI18n from "astro-i18n-aut/integration";

export default defineConfig({
  integrations: [
    tailwind({
      config: { path: "../../packages/config/tailwind/index.js" }
    }),
    astroI18n({
      defaultLanguage: "cs",
      supportedLanguages: ["cs", "en"],
      translationLoadingRules: ["./src/i18n/[lang].json"]
    })
  ],
  site: "https://miccy.github.io"
});
```

### 3. VytvoÅ™enÃ­ pÅ™ekladovÃ½ch souborÅ¯

VytvoÅ™te adresÃ¡Å™ `src/i18n` a v nÄ›m pÅ™ekladovÃ© soubory pro kaÅ¾dÃ½ jazyk:

```json
// src/i18n/cs.json
{
  "nav": {
    "home": "DomÅ¯",
    "about": "O mnÄ›",
    "experience": "ZkuÅ¡enosti",
    "projects": "Projekty",
    "contact": "Kontakt"
  },
  "hero": {
    "title": "Ahoj, jsem MiloÅ¡ Macek",
    "subtitle": "Full Stack Developer",
    "cta": "Zjistit vÃ­ce"
  },
  "about": {
    "title": "O mnÄ›",
    "description": "Jsem full stack vÃ½vojÃ¡Å™ se zamÄ›Å™enÃ­m na...",
    "skills": "Mezi mÃ© dovednosti patÅ™Ã­..."
  }
}
```

```json
// src/i18n/en.json
{
  "nav": {
    "home": "Home",
    "about": "About",
    "experience": "Experience",
    "projects": "Projects",
    "contact": "Contact"
  },
  "hero": {
    "title": "Hi, I'm MiloÅ¡ Macek",
    "subtitle": "Full Stack Developer",
    "cta": "Learn more"
  },
  "about": {
    "title": "About Me",
    "description": "I'm a full stack developer focusing on...",
    "skills": "My skills include..."
  }
}
```

## PouÅ¾itÃ­ pÅ™ekladÅ¯ v komponentÃ¡ch

### 1. ZÃ¡kladnÃ­ pouÅ¾itÃ­

```astro
---
// src/components/Hero.astro
import { useTranslations } from 'astro-i18n-aut';

const t = useTranslations(Astro);
---

<section class="py-20">
  <div class="container mx-auto px-6">
    <h1 class="text-5xl font-bold mb-4">{t('hero.title')}</h1>
    <p class="text-2xl mb-8">{t('hero.subtitle')}</p>
    <a href="#about" class="btn">{t('hero.cta')}</a>
  </div>
</section>
```

### 2. PÅ™epÃ­naÄ jazykÅ¯

VytvoÅ™te komponentu pro pÅ™epÃ­nÃ¡nÃ­ jazykÅ¯:

```astro
---
// packages/ui/components/LanguageSelector/LanguageSelector.astro
import { getLanguageFromURL, useTranslatedPath } from 'astro-i18n-aut';

const currentPath = Astro.url.pathname;
const currentLanguage = getLanguageFromURL(currentPath) || 'cs';
const translatePath = useTranslatedPath(Astro);

const languages = [
  { code: 'cs', name: 'ğŸ‡¨ğŸ‡¿ ÄŒesky' },
  { code: 'en', name: 'ğŸ‡¬ğŸ‡§ English' }
];
---

<div class="language-selector">
  {languages.map(language => (
    <a
      href={translatePath('/', language.code)}
      class={`lang-link ${currentLanguage === language.code ? 'active' : ''}`}
    >
      {language.name}
    </a>
  ))}
</div>

<style>
  .language-selector {
    display: flex;
    gap: 0.5rem;
  }
  .lang-link {
    padding: 0.5rem;
    border-radius: 0.25rem;
    cursor: pointer;
  }
  .lang-link:hover {
    background-color: var(--hover-color);
  }
  .lang-link.active {
    background-color: var(--active-color);
    font-weight: bold;
  }
</style>
```

## RoutovÃ¡nÃ­ pro vÃ­cejazyÄnÃ© strÃ¡nky

### 1. Struktura routovÃ¡nÃ­

Knihovna `astro-i18n-aut` podporuje dva pÅ™Ã­stupy k routovÃ¡nÃ­:

#### A. AutomatickÃ© generovÃ¡nÃ­ routÅ¯

PÅ™i pouÅ¾itÃ­ defaultnÃ­ho nastavenÃ­ se routy pro jazyk vytvoÅ™Ã­ automaticky:

- `/` - vÃ½chozÃ­ jazyk (cs)
- `/en/` - anglickÃ¡ verze
- `/en/about` - anglickÃ¡ verze strÃ¡nky "about"

#### B. ExplicitnÃ­ routovÃ¡nÃ­ pomocÃ­ adresÃ¡Å™ovÃ© struktury

AlternativnÄ› mÅ¯Å¾ete vytvoÅ™it adresÃ¡Å™ovou strukturu:

```
src/pages/
â”œâ”€â”€ index.astro          # VÃ½chozÃ­ jazyk (cs)
â”œâ”€â”€ about.astro          # VÃ½chozÃ­ jazyk (cs)
â”œâ”€â”€ en/
â”‚   â”œâ”€â”€ index.astro      # AnglickÃ¡ hlavnÃ­ strÃ¡nka
â”‚   â””â”€â”€ about.astro      # AnglickÃ¡ strÃ¡nka "about"
```

### 2. Implementace zÃ¡kladnÃ­ strÃ¡nky s pÅ™epÃ­nÃ¡nÃ­m jazyka

```astro
---
// src/pages/index.astro
import { MainLayout } from '@miccy/ui/layouts';
import { useTranslations } from 'astro-i18n-aut';
import Hero from '../components/Hero.astro';
import About from '../components/About.astro';
import Projects from '../components/Projects.astro';

const t = useTranslations(Astro);
---

<MainLayout title={t('meta.homeTitle')} description={t('meta.homeDescription')}>
  <Hero />
  <About />
  <Projects />
</MainLayout>
```

## GenerovÃ¡nÃ­ dynamickÃ½ch strÃ¡nek pro kaÅ¾dÃ½ jazyk

### 1. PouÅ¾itÃ­ Content Collections s vÃ­cejazyÄnostÃ­

VytvoÅ™te Content Collections pro projekty:

```ts
// src/content/config.ts
import { defineCollection, z } from "astro:content";

const projectsCollection = defineCollection({
  schema: z.object({
    title: z.string(),
    description: z.string(),
    image: z.string(),
    tags: z.array(z.string()),
    url: z.string().optional(),
    github: z.string().optional(),
    language: z.enum(["cs", "en"]) // Jazyk obsahu
  })
});

export const collections = {
  projects: projectsCollection
};
```

### 2. VytvoÅ™enÃ­ obsahu pro kaÅ¾dÃ½ jazyk

```md
## // src/content/projects/project-1-cs.md

title: "MÅ¯j Projekt"
description: "Popis projektu v ÄeÅ¡tinÄ›"
image: "/images/project1.jpg"
tags: ["React", "TypeScript", "Tailwind"]
url: "https://example.com"
github: "https://github.com/miccy/project"
language: "cs"

---

DetailnÃ­ popis projektu v ÄeÅ¡tinÄ›...
```

```md
## // src/content/projects/project-1-en.md

title: "My Project"
description: "Project description in English"
image: "/images/project1.jpg"
tags: ["React", "TypeScript", "Tailwind"]
url: "https://example.com"
github: "https://github.com/miccy/project"
language: "en"

---

Detailed project description in English...
```

### 3. DynamickÃ© generovÃ¡nÃ­ strÃ¡nek projektu

```astro
---
// src/pages/project/[slug].astro
import { getCollection } from 'astro:content';
import { MainLayout } from '@miccy/ui/layouts';
import { getLanguageFromURL, useTranslatedPath } from 'astro-i18n-aut';

export async function getStaticPaths() {
  const projects = await getCollection('projects');

  return projects.map(project => {
    const slug = project.id.replace(/-[a-z]{2}$/, ''); // OdstranÄ›nÃ­ jazykovÃ©ho sufixu
    return {
      params: {
        slug
      },
      props: {
        project,
        language: project.data.language
      }
    };
  });
}

const { project, language } = Astro.props;
const { Content } = await project.render();

// ZÃ­skat aktuÃ¡lnÃ­ jazyk z URL
const currentLanguage = getLanguageFromURL(Astro.url.pathname) || 'cs';

// Pokud jazyk obsahu neodpovÃ­dÃ¡ jazyku URL, pÅ™esmÄ›ruj
if (language !== currentLanguage) {
  const translatePath = useTranslatedPath(Astro);
  return Astro.redirect(translatePath(`/project/${Astro.params.slug}`), 302);
}
---

<MainLayout title={project.data.title}>
  <article class="container mx-auto px-6 py-12">
    <h1 class="text-4xl font-bold mb-6">{project.data.title}</h1>
    <p class="text-lg mb-8">{project.data.description}</p>

    <div class="mb-8">
      <img src={project.data.image} alt={project.data.title} class="w-full h-auto rounded-lg" />
    </div>

    <div class="prose dark:prose-invert max-w-none">
      <Content />
    </div>
  </article>
</MainLayout>
```

## SEO pro vÃ­cejazyÄnÃ© strÃ¡nky

### 1. PÅ™idÃ¡nÃ­ hreflang tagÅ¯

VytvoÅ™te komponentu pro hreflang tagy:

```astro
---
// src/components/HreflangTags.astro
import { useTranslatedPath } from 'astro-i18n-aut';

interface Props {
  supportedLanguages: string[];
  currentPath: string;
}

const { supportedLanguages, currentPath } = Astro.props;
const translatePath = useTranslatedPath(Astro);
const canonicalUrl = new URL(currentPath, Astro.site);
---

{supportedLanguages.map(lang => (
  <link
    rel="alternate"
    hreflang={lang}
    href={new URL(translatePath(currentPath, lang), Astro.site).href}
  />
))}
<link rel="canonical" href={canonicalUrl} />
```

### 2. PouÅ¾itÃ­ v layoutu

```astro
---
// packages/ui/layouts/MainLayout/MainLayout.astro
import HreflangTags from '../../components/HreflangTags.astro';

// ... existujÃ­cÃ­ kÃ³d ...

const supportedLanguages = ['cs', 'en'];
const currentPath = Astro.url.pathname;
---

<html lang={lang}>
  <head>
    <!-- ... existujÃ­cÃ­ meta tagy ... -->
    <HreflangTags
      supportedLanguages={supportedLanguages}
      currentPath={currentPath}
    />
  </head>
  <!-- ... existujÃ­cÃ­ kÃ³d ... -->
</html>
```

## PÅ™eklad dynamickÃ©ho obsahu

### 1. NaÄÃ­tÃ¡nÃ­ pÅ™ekladÅ¯ v JavaScript

```ts
// src/utils/i18n.ts
import { getLanguageFromURL } from "astro-i18n-aut";

export async function getTranslations(language: string) {
  const defaultLanguage = "cs";
  const lang = language || defaultLanguage;

  try {
    const translations = await import(`../i18n/${lang}.json`);
    return translations.default;
  } catch (e) {
    console.error(`Failed to load translations for ${lang}`, e);
    // Fallback na vÃ½chozÃ­ jazyk
    const defaultTranslations = await import(`../i18n/${defaultLanguage}.json`);
    return defaultTranslations.default;
  }
}

export function getCurrentLanguage(url: URL): string {
  return getLanguageFromURL(url.pathname) || "cs";
}
```

### 2. PouÅ¾itÃ­ v klientskÃ½ch komponentÃ¡ch

```astro
---
// src/components/DynamicForm.astro
---

<div id="dynamic-form">
  <!-- Bude naplnÄ›no JavaScript kÃ³dem -->
</div>

<script>
  import { getTranslations, getCurrentLanguage } from '../utils/i18n';

  async function initForm() {
    const language = getCurrentLanguage(window.location);
    const translations = await getTranslations(language);

    const form = document.getElementById('dynamic-form');
    if (!form) return;

    form.innerHTML = `
      <h3>${translations.contact.formTitle}</h3>
      <form>
        <label>${translations.contact.nameLabel}</label>
        <input type="text" placeholder="${translations.contact.namePlaceholder}">

        <label>${translations.contact.emailLabel}</label>
        <input type="email" placeholder="${translations.contact.emailPlaceholder}">

        <label>${translations.contact.messageLabel}</label>
        <textarea placeholder="${translations.contact.messagePlaceholder}"></textarea>

        <button type="submit">${translations.contact.submitButton}</button>
      </form>
    `;
  }

  // Inicializovat pÅ™i naÄtenÃ­ strÃ¡nky
  document.addEventListener('DOMContentLoaded', initForm);

  // Reinicializovat pÅ™i navigaci (pro SPA chovÃ¡nÃ­)
  document.addEventListener('astro:page-load', initForm);
</script>
```

## Optimalizace pÅ™ekladÅ¯

### 1. DÄ›lenÃ­ pÅ™ekladÅ¯ pro lepÅ¡Ã­ vÃ½kon

Pro rozsÃ¡hlejÅ¡Ã­ pÅ™eklady je vhodnÃ© rozdÄ›lit je do menÅ¡Ã­ch souborÅ¯:

```
src/i18n/
â”œâ”€â”€ cs/
â”‚   â”œâ”€â”€ common.json
â”‚   â”œâ”€â”€ home.json
â”‚   â”œâ”€â”€ about.json
â”‚   â””â”€â”€ projects.json
â”œâ”€â”€ en/
â”‚   â”œâ”€â”€ common.json
â”‚   â”œâ”€â”€ home.json
â”‚   â”œâ”€â”€ about.json
â”‚   â””â”€â”€ projects.json
```

### 2. NaÄÃ­tÃ¡nÃ­ pouze potÅ™ebnÃ½ch pÅ™ekladÅ¯

```ts
// src/utils/i18n.ts
export async function getPageTranslations(language: string, page: string) {
  const defaultLanguage = "cs";
  const lang = language || defaultLanguage;

  try {
    // NaÄÃ­st obecnÃ© pÅ™eklady
    const commonTranslations = await import(`../i18n/${lang}/common.json`);

    // NaÄÃ­st pÅ™eklady pro konkrÃ©tnÃ­ strÃ¡nku
    const pageTranslations = await import(`../i18n/${lang}/${page}.json`);

    // SlouÄit pÅ™eklady
    return {
      ...commonTranslations.default,
      ...pageTranslations.default
    };
  } catch (e) {
    console.error(`Failed to load translations for ${lang}/${page}`, e);
    return {};
  }
}
```

## ZÃ¡vÄ›r

Tato implementace vÃ­cejazyÄnosti poskytuje robustnÃ­ zÃ¡klad pro vytvoÅ™enÃ­ dvojjazyÄnÃ©ho portfolia pomocÃ­ Astro. PÅ™Ã­stup s knihovnou `astro-i18n-aut` nabÃ­zÃ­ dostateÄnou flexibilitu pro vÄ›tÅ¡inu bÄ›Å¾nÃ½ch pÅ™Ã­padÅ¯ pouÅ¾itÃ­ a umoÅ¾Åˆuje snadnÃ© pÅ™idÃ¡nÃ­ dalÅ¡Ã­ch jazykÅ¯ v budoucnu.

Pro rozÅ¡Ã­Å™enÄ›jÅ¡Ã­ projekty nebo specifickÃ© potÅ™eby lze zvÃ¡Å¾it komplexnÄ›jÅ¡Ã­ Å™eÅ¡enÃ­ jako `astro-i18next` nebo vlastnÃ­ implementaci zaloÅ¾enou na Content Collections a dynamickÃ½ch routech.
